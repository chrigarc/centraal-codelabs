<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="shared-styles.html">

<dom-module id="lab-view">
  <template>
    <style include="shared-styles">
      :host {
        display: block;

        padding: 10px;
      }
    </style>
    <div class="card">
      <h2>[[uidLab]]</h2>
      <template is="dom-repeat" items="[[content]]">

      </template>
    </div>
    <div class="card">
      <h2>[[lab.title]]</h2>

    </div>
  </template>

  <script>
    class LabView extends Polymer.Element {
      static get is() { return 'lab-view'; }
      static get properties() {
          return {
              uidLab: {
                  type: String,
                  value: '',
                  observer: 'getLab'
              },
              content: {
                  type: Object,
                  value: []
              },
              userUid: {
                  type: String,
                  value: ''
              }
          };
      }

      connectedCallback() {
          super.connectedCallback();
      }

      getLab(){
          const lavsRef = firebase.database().ref('labs-content/' + this.uidLab);
          lavsRef.once('value', (snapshot) =>{
              const values = snapshot.val();
              if(values){
                  const newContent = [];
                  for(const item in values){
                      newContent.push(Object.assign({}, {uid:item}, values[item]));
                  }
                  this.content = newContent;
                  console.log(this.content);
              }
          });
      }
    }

    window.customElements.define(LabView.is, LabView);
  </script>
</dom-module>
